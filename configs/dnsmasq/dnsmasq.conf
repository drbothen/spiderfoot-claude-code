# dnsmasq configuration for OSINT lab
# Resolves *.acme-corp.lab to appropriate containers

# Don't use /etc/resolv.conf
no-resolv

# Upstream DNS for external queries
server=8.8.8.8
server=8.8.4.4

# Local domain
local=/acme-corp.lab/
domain=acme-corp.lab

# Primary domain and www (use host-record for exact match, not wildcard)
host-record=acme-corp.lab,172.28.0.10
host-record=www.acme-corp.lab,172.28.0.10

# Shadow IT subdomains
address=/dev.acme-corp.lab/172.28.0.11
address=/staging.acme-corp.lab/172.28.0.12
address=/api.acme-corp.lab/172.28.0.13
address=/old.acme-corp.lab/172.28.0.14
address=/files.acme-corp.lab/172.28.0.15
address=/vpn.acme-corp.lab/172.28.0.16

# Additional discoverable subdomains (for enumeration demos)
address=/mail.acme-corp.lab/172.28.0.10
address=/ftp.acme-corp.lab/172.28.0.14
address=/test.acme-corp.lab/172.28.0.11
address=/backup.acme-corp.lab/172.28.0.15
address=/admin.acme-corp.lab/172.28.0.12
address=/portal.acme-corp.lab/172.28.0.12
address=/intranet.acme-corp.lab/172.28.0.10
address=/jenkins.acme-corp.lab/172.28.0.11
address=/gitlab.acme-corp.lab/172.28.0.11
address=/grafana.acme-corp.lab/172.28.0.13

# Breach API for mock HIBP
address=/breach-api.lab.local/172.28.0.20

# Threat Intel API for mock VirusTotal/GreyNoise/AbuseIPDB/Shodan
address=/threatintel-api.lab.local/172.28.0.21
address=/virustotal.lab.local/172.28.0.21
address=/greynoise.lab.local/172.28.0.21
address=/abuseipdb.lab.local/172.28.0.21
address=/shodan.lab.local/172.28.0.21

# Log queries for debugging
log-queries
log-facility=/var/log/dnsmasq.log
